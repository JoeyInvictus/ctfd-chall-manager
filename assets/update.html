{% extends "admin/challenges/update.html" %}

<style>
	#cm-mode-until {
	  display: none;
	}
</style>

{% block value %}

<!-- CM Plugins -->
<div class="form-group">
	<label for="value">Mana Cost<br>
		<small class="form-text text-muted">
			This is how many points the challenge will cost to User to start it.
		</small>
	</label>
	<input type="number" class="form-control" name="mana_cost" value="{{ challenge.mana_cost }}">
</div>

<div id="cm-mode-selector" class="form-group">
	<label for="select-option">Select mode </label>
	<select id="select-option" name="mode">
		<option value="until">Until</option>
		<option value="timeout" selected>Timeout</option>
	</select>
</div>

<div id="cm-mode-until" style="display: none;" class="form-group">
	<label for="value">Until<br>
		<small class="form-text text-muted">
			This is when the Scenario has to end. 
		</small>
	</label>
	<input type="datetime-local" id="until-input" class="form-control" name="until" value="{{ challenge.until }}">
</div>

<div id="cm-mode-timeout" class="form-group">
	<label for="value">Timeout<br>
		<small class="form-text text-muted">
			This is default timeout (int) <b>in seconds</b> for the Scenario to shutdown itself.
		</small>
	</label>
	<input type="number" id="timeout-input" class="form-control" name="timeout" value="{{ challenge.timeout }}">
</div>

<div id="current-scenario-id" style="display: none;">{{ challenge.scenario_id }}</div>

<div id="scenario_file">
	<!-- <tr>
		<td class="text-center">
			<a href="{{ url_for('views.files', path=challenge.scenario_id) }}">
				{{ challenge.scenario_id }}
			</a>
		</td>
		<td class="text-center">
			<i role="button" class="btn-fa fas fa-times delete-file"></i>
		</td>
	</tr> -->

</div>

<div class="form-group">
	<label for="value">Scenario archive<br>
		<small class="form-text text-muted">
			This is the IaC Archives
		</small>
	</label>
	<input type="file" class="form-control" id="scenario" name="scenario" accept=".zip">
</div>


<!-- CM Plugins -->

<div class="form-group">
	<label for="value">Current Value<br> 
		<small class="form-text text-muted">
			This is how many points the challenge is worth right now.
		</small>
	</label>
	<input type="number" class="form-control chal-value" name="value" value="{{ challenge.value }}" disabled>
</div>

<div class="form-group">
	<label for="value">Initial Value<br>
		<small class="form-text text-muted">
			This is how many points the challenge was worth initially.
		</small>
	</label>
	<input type="number" class="form-control chal-initial" name="initial" value="{{ challenge.initial }}" required>
</div>

<div class="form-group">
	<label for="value">Decay Function<br>
		<small class="form-text text-muted">
			<span>How the dynamic value will be calculated based on the Decay value</span>
			<ul>
				<li>Linear: Calculated as <code>Initial - (Decay * SolveCount)</code></li>
				<li>Logarithmic: Calculated as <code>(((Minimum - Initial) / (Decay^2)) * (SolveCount^2)) + Initial</code></li>
			</ul>
		</small>
	</label>
	<select name="function" class="custom-select">
		<option value="linear" {% if challenge.function == "linear" %}selected{% endif %}>Linear</option>
		<option value="logarithmic" {% if challenge.function == "logarithmic" %}selected{% endif %}>Logarithmic</option>
	</select>
</div>

<div class="form-group">
	<label for="value">Decay<br>
		<small class="form-text text-muted">
			<span>The decay value is used differently depending on the above Decay Function</span>
			<ul>
				<li>Linear: The amount of points deducted per solve. Equal deduction per solve.</li>
				<li>Logarithmic: The amount of solves before the challenge reaches its minimum value. Earlier solves will lose less points. Later solves will lose more points</li>
			</ul>
		</small>
	</label>
	<input type="number" class="form-control chal-decay" min="1" name="decay" value="{{ challenge.decay }}" required>
</div>

<div class="form-group">
	<label for="value">Minimum Value<br>
		<small class="form-text text-muted">
			This is the lowest that the challenge can be worth
		</small>
	</label>
	<input type="number" class="form-control chal-minimum" name="minimum" value="{{ challenge.minimum }}" required>
</div>
{% endblock %}